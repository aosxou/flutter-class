# ì•± ì‹¤í–‰ êµ¬ì¡°
## main.dart
```dart
WidgetsFlutterBinding.ensureInitialized();
prefs = await SharedPreferences.getInstance();
```
# ê¸°ëŠ¥
SharedPreferences ì´ˆê¸°í™”

ì•± ì„¤ì • ì •ë³´ ìœ ì§€

## App ì§„ì… ì²˜ë¦¬ (Init / Splash ë¶„ê¸°)
```dart
bool isInitStarted = prefs.getBool('isInitStarted') ?? true;

ê°’	ì´ë™ í™”ë©´
true	InitStartPage
false	SplashPage
```

# í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°” êµ¬ì¡°

```dart
root.dart
TabBarView(
  children: [
    HomePage(),
    ë™ë„¤ìƒí™œ,
    ë‚´ ê·¼ì²˜,
    ì±„íŒ…,
    ë‚˜ì˜ ë°¤í†¨
  ]
)
```

## BottomNavigationController

menuIndex ìƒíƒœ ê´€ë¦¬

TabController ì—°ë™

í™”ë©´íƒ­ ë³€ê²½ ì²˜ë¦¬

# í™ˆ í™”ë©´ êµ¬ì¡°

HomeController

ProductRepository í†µí•œ ìƒí’ˆ ë°ì´í„° ê´€ë¦¬

Firebase Storage ì—°ë™

## ìƒí’ˆ ë“±ë¡ ê¸°ëŠ¥

ProductWriteController ì—­í• 

ì´ˆê¸° êµ¬ì„±
```dart
ProductWriteController(
  UserModel owner,
  ProductRepository,
  CloudFirebaseRepository
)
```
## ìƒí’ˆ ìœ íš¨ì„± ê²€ì‚¬
```dart
if (ì‚¬ì§„ && ê°€ê²© >= 0 && ì œëª© != '') {
  ë“±ë¡ ê°€ëŠ¥
}
```

 ë“±ë¡ ë²„íŠ¼ì€ ì¡°ê±´ ë§Œì¡± ì‹œ í™œì„±í™”

## ì´ë¯¸ì§€ ì„ íƒ

photo_manager ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©

ìµœëŒ€ 10ì¥

ì„ íƒ, ì‚­ì œ ê°€ëŠ¥
```dart
RxList<AssetEntity> selectedImages;
```
ğŸ’° ê°€ê²© & ë¬´ë£Œ ë‚˜ëˆ”
productPrice â‰¥ 0
isFree == true â†’ price = 0

## ì¹´í…Œê³ ë¦¬ ì„ íƒ
```dart
ProductCategorySelector ì‚¬ìš©
```

## ê±°ë˜ í¬ë§ ì¥ì†Œ ì„¤ì •

ì§€ë„ UI ì œê³µ

ìœ„ì¹˜ ì„ íƒ í›„ ì €ì¥

wantTradeLocation
wantTradeLocationLabel


## ìƒí’ˆ ìµœì¢… ë“±ë¡

submit()

ì²˜ë¦¬ ê³¼ì •

product ê°ì²´ ìƒì„±

Firestore ì €ì¥

ë“±ë¡ ì™„ë£Œ ì•Œë¦¼

# ê³µí†µ UI ê´€ë¦¬
```dart
AppFont
class AppFont extends StatelessWidget
```
# ê³µí†µ í°íŠ¸ ì ìš©

ìƒ‰ìƒ, í¬ê¸°, êµµê¸° ì»¤ìŠ¤í…€

## ì‚¬ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬
| êµ¬ë¶„       | ë¼ì´ë¸ŒëŸ¬ë¦¬              |
| -------- | ------------------ |
| ìƒíƒœ ê´€ë¦¬    | get                |
| ì´ë¯¸ì§€      | flutter_svg        |
| ê°¤ëŸ¬ë¦¬      | photo_manager      |
| ì§€ë„       | flutter_map        |
| ìœ„ì¹˜       | geolocator         |
| ë¡œì»¬ ì €ì¥    | shared_preferences |
| í•´ì‹œ       | crypto             |
| UUID     | uuid               |


## í”„ë¡œì íŠ¸ ê¸°ëŠ¥ ìš”ì•½

| ê¸°ëŠ¥         | êµ¬í˜„                |
| ---------- | ----------------- |
| ë¡œê·¸ì¸ / ë¡œê·¸ì•„ì›ƒ | âœ…                 |
| ìƒí’ˆ ë“±ë¡      | âœ…                 |
| ì´ë¯¸ì§€ ì—…ë¡œë“œ    | âœ…                 |
| ê±°ë˜ ìœ„ì¹˜ ì„ íƒ   | âœ…                 |
| í•˜ë‹¨ ë„¤ë¹„      | âœ…                 |
| ìƒíƒœ ê´€ë¦¬      | GetX              |
| ì´ˆê¸° ì„¤ì • ì €ì¥   | SharedPreferences |

## product_category_selector ì „ì²´ ì½”ë“œ

```dart
import 'package:bamtol_market_app/src/common/components/app_font.dart';
import 'package:bamtol_market_app/src/common/enum/market_enum.dart';
import 'package:flutter/material.dart';
import 'package:get/get.dart';

class ProductCategorySelector extends StatelessWidget {
  final ProductCategoryType? initType;
  const ProductCategorySelector({super.key, this.initType});

  @override
  Widget build(BuildContext context) {
    var types = ProductCategoryType.values
        .where((element) => element.code != '')
        .toList();
    return Material(
      color: Colors.black.withOpacity(0.5),
      child: Stack(
        children: [
          Positioned(
              left: 0,
              right: 0,
              bottom: 0,
              top: 0,
              child: GestureDetector(
                onTap: () {
                  Get.back();
                },
                behavior: HitTestBehavior.translucent,
              )),
          Center(
            child: Padding(
              padding: const EdgeInsets.all(25),
              child: Container(
                height: Get.height * 0.7,
                color: const Color(0xff212123),
                child: SingleChildScrollView(
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.stretch,
                    children: List.generate(
                      types.length,
                      (index) => GestureDetector(
                        onTap: () {
                          Get.back(result: types[index]);
                        },
                        behavior: HitTestBehavior.translucent,
                        child: Padding(
                          padding: const EdgeInsets.all(20),
                          child: AppFont(
                            types[index].name,
                            color: initType == null
                                ? Colors.white
                                : initType?.code == types[index].code
                                    ? const Color(0xffFD6F1F)
                                    : Colors.white,
                          ),
                        ),
                      ),
                    ),
                  ),
                ),
              ),
            ),
          ),
        ],
      ),
    );
  }
}

```
## trade_location_map ì „ì²´ ì½”ë“œ

```dart
import 'package:bamtol_market_app/src/common/components/app_font.dart';
import 'package:bamtol_market_app/src/common/components/btn.dart';
import 'package:bamtol_market_app/src/common/components/place_name_popup.dart';
import 'package:flutter/material.dart';
import 'package:flutter_map/flutter_map.dart';
import 'package:flutter_svg/flutter_svg.dart';
import 'package:geolocator/geolocator.dart';
import 'package:get/get.dart';
import 'package:latlong2/latlong.dart';

class TradeLocationMap extends StatefulWidget {
  final String? label;
  final LatLng? location;
  const TradeLocationMap({
    super.key,
    this.label,
    this.location,
  });

  @override
  State<TradeLocationMap> createState() => _TradeLocationMapState();
}

class _TradeLocationMapState extends State<TradeLocationMap> {
  final _mapController = MapController();
  String lable = '';
  LatLng? location;

  @override
  void initState() {
    super.initState();
    lable = widget.label ?? '';
    location = widget.location;
  }

  Future<Position> _determinePosition() async {
    bool serviceEnabled;
    LocationPermission permission;

    serviceEnabled = await Geolocator.isLocationServiceEnabled();
    if (!serviceEnabled) {
      return Future.error('ìœ„ì¹˜ ì„œë¹„ìŠ¤ê°€ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    permission = await Geolocator.checkPermission();
    if (permission == LocationPermission.denied) {
      permission = await Geolocator.requestPermission();
      if (permission == LocationPermission.denied) {
        return Future.error('ìœ„ì¹˜ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }

    if (permission == LocationPermission.deniedForever) {
      return Future.error('ìœ„ì¹˜ ê¶Œí•œì´ ì˜êµ¬ì ìœ¼ë¡œ ê±°ë¶€ë˜ì–´ ê¶Œí•œì„ ìš”ì²­í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    }

    return await Geolocator.getCurrentPosition();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: const Color(0xff212123),
      appBar: AppBar(
        elevation: 0,
        leading: GestureDetector(
          behavior: HitTestBehavior.translucent,
          onTap: Get.back,
          child: Padding(
            padding: const EdgeInsets.all(10.0),
            child: SvgPicture.asset('assets/svg/icons/back.svg'),
          ),
        ),
      ),
      body: Column(
        crossAxisAlignment: CrossAxisAlignment.stretch,
        children: [
          const Padding(
            padding: EdgeInsets.all(20.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.stretch,
              children: [
                AppFont(
                  'ì´ì›ƒê³¼ ë§Œë‚˜ì„œ\nê±°ë˜í•˜ê³  ì‹¶ì€ ì¥ì†Œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.',
                  fontWeight: FontWeight.bold,
                  size: 16,
                ),
                SizedBox(height: 15),
                AppFont(
                  'ë§Œë‚˜ì„œ ê±°ë˜í•  ë•ŒëŠ” ëˆ„êµ¬ë‚˜ ì°¾ê¸° ì‰¬ìš´ ê³µê³µì¥ì†Œê°€ ì¢‹ì•„ìš”.',
                  size: 13,
                ),
              ],
            ),
          ),
          Expanded(
            child: FutureBuilder<Position>(
              future: _determinePosition(),
              builder: (context, snapshot) {
                if (snapshot.hasData) {
                  var myLocation =
                      LatLng(snapshot.data!.latitude, snapshot.data!.longitude);
                  if (location != null) {
                    myLocation = location!;
                  }
                  return FlutterMap(
                    mapController: _mapController,
                    options: MapOptions(
                      center: myLocation,
                      interactiveFlags:
                          InteractiveFlag.pinchZoom | InteractiveFlag.drag,
                      onPositionChanged: (position, hasGesture) {
                        if (hasGesture) {
                          setState(() {
                            lable = '';
                          });
                        }
                      },
                    ),
                    children: [
                      TileLayer(
                        urlTemplate:
                            "https://tile.openstreetmap.org/{z}/{x}/{y}.png",
                      ),
                    ],
                    nonRotatedChildren: [
                      if (lable != '')
                        Center(
                          child: Column(
                            mainAxisAlignment: MainAxisAlignment.center,
                            children: [
                              Container(
                                padding: const EdgeInsets.symmetric(
                                    vertical: 7, horizontal: 15),
                                decoration: BoxDecoration(
                                  borderRadius: BorderRadius.circular(7),
                                  color: Color.fromARGB(255, 208, 208, 208),
                                ),
                                child: AppFont(
                                  lable,
                                  color: Colors.black,
                                  size: 12,
                                ),
                              ),
                              const SizedBox(height: 100)
                            ],
                          ),
                        ),
                      Center(
                        child: SvgPicture.asset(
                          'assets/svg/icons/want_location_marker.svg',
                          width: 45,
                        ),
                      ),
                      Align(
                        alignment: Alignment.bottomCenter,
                        child: Padding(
                          padding: EdgeInsets.only(
                              bottom: Get.mediaQuery.padding.bottom),
                          child: SizedBox(
                            width: double.infinity,
                            child: Padding(
                              padding: const EdgeInsets.all(15.0),
                              child: Btn(
                                onTap: () async {
                                  var result = await Get.dialog<String>(
                                    useSafeArea: false,
                                    PlaceNamePopup(),
                                  );
                                  Get.back(result: {
                                    'label': result,
                                    'location': _mapController.center
                                  });
                                },
                                child: const AppFont(
                                  'ì„ íƒ ì™„ë£Œ',
                                  align: TextAlign.center,
                                ),
                              ),
                            ),
                          ),
                        ),
                      )
                    ],
                  );
                }

                return const Center(
                  child: CircularProgressIndicator(
                    strokeWidth: 1,
                  ),
                );
              },
            ),
          )
        ],
      ),
      floatingActionButton: Padding(
        padding: EdgeInsets.only(bottom: Get.mediaQuery.padding.bottom + 30),
        child: FloatingActionButton(
          onPressed: () {},
          backgroundColor: const Color(0xff212123),
          child: Icon(Icons.location_searching),
        ),
      ),
    );
  }
}

```